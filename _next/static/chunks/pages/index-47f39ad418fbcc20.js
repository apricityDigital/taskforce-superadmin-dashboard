(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{3756:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(4297);let r=(0,a.Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},4976:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(4297);let r=(0,a.Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},9461:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var a=s(4297);let r=(0,a.Z)("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]])},8312:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(4433)}])},5140:function(e,t,s){"use strict";s.d(t,{D:function(){return DataService}});var a=s(9828),r=s(7889);let DataService=class DataService{static async getDashboardStats(){try{let[e,t,s,i,l,c,o,n]=await Promise.all([(0,a.PL)((0,a.hJ)(r.db,"approvedUsers")),(0,a.PL)((0,a.IO)((0,a.hJ)(r.db,"approvedUsers"),(0,a.ar)("isActive","==",!0))),(0,a.PL)((0,a.IO)((0,a.hJ)(r.db,"accessRequests"),(0,a.ar)("status","==","pending"))),(0,a.PL)((0,a.hJ)(r.db,"complianceReports")),(0,a.PL)((0,a.hJ)(r.db,"inspections")),(0,a.PL)((0,a.hJ)(r.db,"feederPoints")),(0,a.PL)((0,a.hJ)(r.db,"teams")),(0,a.PL)((0,a.hJ)(r.db,"ipRecords"))]),d=e.docs.map(e=>({id:e.id,...e.data()})),m=t.docs.map(e=>({id:e.id,...e.data()})),u=d.filter(e=>"admin"===e.role).length,p=d.filter(e=>"task_force_team"===e.role).length,h=d.filter(e=>"commissioner"===e.role).length,x=d.filter(e=>!e.isActive).length,g=m.filter(e=>"admin"===e.role).length,b=m.filter(e=>"task_force_team"===e.role).length,f=m.filter(e=>"commissioner"===e.role).length;return{totalUsers:e.size,activeUsers:t.size,pendingRequests:s.size,totalComplaints:i.size,totalInspections:l.size,totalFeederPoints:c.size,totalTeams:o.size,totalIPRecords:n.size,adminUsers:u,taskForceUsers:p,commissionerUsers:h,inactiveUsers:x,activeAdmins:g,activeTaskForce:b,activeCommissioners:f}}catch(e){return console.error("Error fetching dashboard stats:",e),{totalUsers:0,activeUsers:0,pendingRequests:0,totalComplaints:0,totalInspections:0,totalFeederPoints:0,totalTeams:0,totalIPRecords:0,adminUsers:0,taskForceUsers:0,commissionerUsers:0,inactiveUsers:0,activeAdmins:0,activeTaskForce:0,activeCommissioners:0}}}static onUsersChange(e){let t=(0,a.IO)((0,a.hJ)(r.db,"approvedUsers"),(0,a.Xo)("createdAt","desc"));return(0,a.cf)(t,t=>{let s=t.docs.map(e=>({id:e.id,...e.data()}));e(s)})}static async getAllUsers(){let e=(0,a.IO)((0,a.hJ)(r.db,"approvedUsers")),t=await (0,a.PL)(e),s=t.docs.map(e=>({id:e.id,...e.data()}));return s}static onAccessRequestsChange(e){let t=(0,a.IO)((0,a.hJ)(r.db,"accessRequests"),(0,a.Xo)("createdAt","desc"));return(0,a.cf)(t,t=>{let s=t.docs.map(e=>({id:e.id,...e.data()}));e(s)})}static onComplaintsChange(e){let t=(0,a.IO)((0,a.hJ)(r.db,"complaints"),(0,a.Xo)("createdAt","desc"));return(0,a.cf)(t,t=>{let s=t.docs.map(e=>({id:e.id,...e.data()}));e(s)})}static async getAllComplaints(){let e=(0,a.IO)((0,a.hJ)(r.db,"complaints")),t=await (0,a.PL)(e),s=t.docs.map(e=>({id:e.id,...e.data()}));return s}static async getAllComplianceReports(){let e=(0,a.IO)((0,a.hJ)(r.db,"complianceReports"),(0,a.Xo)("submittedAt","desc")),t=await (0,a.PL)(e),s=t.docs.map(e=>({id:e.id,...e.data()}));return s}static onComplianceReportsChange(e){let t=(0,a.IO)((0,a.hJ)(r.db,"complianceReports"),(0,a.Xo)("submittedAt","desc"));return(0,a.cf)(t,t=>{let s=t.docs.map(e=>({id:e.id,...e.data()}));e(s)})}static async updateComplianceReportStatus(e,t,s,i){try{let l={status:t,reviewedAt:(0,a.Bt)(),updatedAt:(0,a.Bt)()};s&&(l.adminNotes=s),i&&(l.reviewedBy=i),await (0,a.r7)((0,a.JU)(r.db,"complianceReports",e),l),console.log("✅ Compliance report status updated:",e,t)}catch(e){throw console.error("❌ Error updating compliance report status:",e),e}}static onIPRecordsChange(e){let t=(0,a.IO)((0,a.hJ)(r.db,"ipRecords"),(0,a.Xo)("registeredAt","desc"));return(0,a.cf)(t,t=>{let s=t.docs.map(e=>({id:e.id,...e.data()}));e(s)})}static onFeederPointsChange(e){let t=(0,a.IO)((0,a.hJ)(r.db,"feederPoints"));return(0,a.cf)(t,t=>{let s=t.docs.map(e=>({id:e.id,...e.data()}));e(s)})}static async getAllFeederPoints(){let e=(0,a.IO)((0,a.hJ)(r.db,"feederPoints")),t=await (0,a.PL)(e),s=t.docs.map(e=>({id:e.id,...e.data()}));return s}static onTeamsChange(e){let t=(0,a.IO)((0,a.hJ)(r.db,"teams"));return(0,a.cf)(t,t=>{let s=t.docs.map(e=>({id:e.id,...e.data()}));e(s)})}static async updateFeederPoint(e,t){let s=(0,a.JU)(r.db,"feederPoints",e);await (0,a.r7)(s,t)}static async createFeederPoint(e){let t=(0,a.hJ)(r.db,"feederPoints");await (0,a.pl)((0,a.JU)(t),e,{merge:!0})}static async deleteFeederPoint(e){let t=(0,a.JU)(r.db,"feederPoints",e);await (0,a.oe)(t)}static async createSampleFeederPoints(){let e=(0,a.hJ)(r.db,"feederPoints");for(let t of[{name:"FP-001",status:"active",priority:"high",location:{address:"123 Main St",latitude:34.0522,longitude:-118.2437}},{name:"FP-002",status:"maintenance",priority:"medium",location:{address:"456 Oak Ave",latitude:34.0522,longitude:-118.2437}},{name:"FP-003",status:"inactive",priority:"low",location:{address:"789 Pine Ln",latitude:34.0522,longitude:-118.2437}}])await (0,a.pl)((0,a.JU)(e),t)}static async getRecentActivity(){try{let e=(0,a.IO)((0,a.hJ)(r.db,"recentActivity"),(0,a.Xo)("timestamp","desc"),(0,a.b9)(10)),t=await (0,a.PL)(e),s=t.docs.map(e=>({id:e.id,...e.data()}));return s}catch(e){return console.error("Error fetching recent activity:",e),[]}}static async approveAccessRequest(e){try{let t=(0,a.JU)(r.db,"accessRequests",e.id);await (0,a.r7)(t,{status:"approved",reviewedAt:(0,a.Bt)(),reviewedBy:"AdminUserPlaceholder",updatedAt:(0,a.Bt)()}),console.log("✅ Access request approved:",e.id)}catch(e){throw console.error("❌ Error approving access request:",e),e}}static async rejectAccessRequest(e){try{let t=(0,a.JU)(r.db,"accessRequests",e);await (0,a.r7)(t,{status:"rejected",reviewedAt:(0,a.Bt)(),reviewedBy:"AdminUserPlaceholder",updatedAt:(0,a.Bt)()}),console.log("✅ Access request rejected:",e)}catch(e){throw console.error("❌ Error rejecting access request:",e),e}}static async updateComplaint(e,t){try{let s=(0,a.JU)(r.db,"complaints",e);await (0,a.r7)(s,{...t,updatedAt:(0,a.Bt)()}),console.log("✅ Complaint updated:",e)}catch(e){throw console.error("❌ Error updating complaint:",e),e}}static async deleteComplaint(e){try{await (0,a.oe)((0,a.JU)(r.db,"complaints",e)),console.log("✅ Complaint deleted:",e)}catch(e){throw console.error("❌ Error deleting complaint:",e),e}}static async testDatabaseConnection(){try{console.log("Attempting to fetch collections from Firestore...");let e=await Promise.all([(0,a.PL)((0,a.hJ)(r.db,"approvedUsers")),(0,a.PL)((0,a.hJ)(r.db,"accessRequests")),(0,a.PL)((0,a.hJ)(r.db,"complianceReports")),(0,a.PL)((0,a.hJ)(r.db,"feederPoints")),(0,a.PL)((0,a.hJ)(r.db,"teams"))]);return console.log("Successfully fetched collections:"),console.log("- approvedUsers: ".concat(e[0].size," documents")),console.log("- accessRequests: ".concat(e[1].size," documents")),console.log("- complianceReports: ".concat(e[2].size," documents")),console.log("- feederPoints: ".concat(e[3].size," documents")),console.log("- teams: ".concat(e[4].size," documents")),!0}catch(e){return console.error("Error testing database connection:",e),!1}}static async getUserReports(e){let t=(0,a.IO)((0,a.hJ)(r.db,"complianceReports"),(0,a.ar)("userId","==",e)),s=await (0,a.PL)(t);return s.docs.map(e=>({id:e.id,...e.data()}))}static async getUserFeederPoints(e){let t=(0,a.IO)((0,a.hJ)(r.db,"feederPoints"),(0,a.ar)("assignedUserId","==",e)),s=await (0,a.PL)(t);return s.docs.map(e=>({id:e.id,...e.data()}))}static async updateUser(e,t){let s=(0,a.JU)(r.db,"approvedUsers",e);await (0,a.r7)(s,t)}static async deleteUser(e){let t=(0,a.JU)(r.db,"approvedUsers",e);await (0,a.oe)(t)}}},7889:function(e,t,s){"use strict";s.d(t,{db:function(){return l}});var a=s(3977),r=s(9828);let i=(0,a.ZF)({apiKey:"AIzaSyAUl-1iNJo7MjMgKk_vBaBKeDNEYVSxSDE",authDomain:"task-force-b1ff7.firebaseapp.com",projectId:"task-force-b1ff7",storageBucket:"task-force-b1ff7.firebasestorage.app",messagingSenderId:"1029709761200",appId:"1:1029709761200:web:d051815003907ec7f14975"}),l=(0,r.ad)(i)},4433:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Dashboard}});var a=s(5893),r=s(7294),i=s(9525),l=s(9455),c=s(9062),o=s(7966),n=s(7737),d=s(4976),m=s(4297);let u=(0,m.Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var p=s(9461),h=s(3756),x=s(1408),g=s(5140);function SimpleDashboard(){let[e,t]=(0,r.useState)(null),[s,m]=(0,r.useState)([]),[b,f]=(0,r.useState)(!0),[v,y]=(0,r.useState)(1);(0,r.useEffect)(()=>{loadDashboardData()},[]);let loadDashboardData=async()=>{f(!0);try{let[e,s]=await Promise.all([g.D.getDashboardStats(),g.D.getAllFeederPoints()]);t(e),m(s)}catch(e){console.error("Error loading dashboard data:",e)}finally{f(!1)}};if(b)return(0,a.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,a.jsx)("div",{className:"w-16 h-16 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin"})});let j=[{title:"Total Users",value:(null==e?void 0:e.totalUsers)||0,icon:i.Z,color:"bg-gradient-to-br from-blue-500 to-blue-600",subtitle:"".concat((null==e?void 0:e.activeUsers)||0," active")},{title:"Admin Users",value:(null==e?void 0:e.adminUsers)||0,icon:l.Z,color:"bg-gradient-to-br from-red-500 to-red-600",subtitle:"".concat((null==e?void 0:e.activeAdmins)||0," active")},{title:"Task Force Team",value:(null==e?void 0:e.taskForceUsers)||0,icon:c.Z,color:"bg-gradient-to-br from-emerald-500 to-emerald-600",subtitle:"".concat((null==e?void 0:e.activeTaskForce)||0," active")},{title:"Commissioners",value:(null==e?void 0:e.commissionerUsers)||0,icon:o.Z,color:"bg-gradient-to-br from-purple-500 to-purple-600",subtitle:"".concat((null==e?void 0:e.activeCommissioners)||0," active")},{title:"Pending Requests",value:(null==e?void 0:e.pendingRequests)||0,icon:o.Z,color:"bg-gradient-to-br from-amber-500 to-amber-600",subtitle:"Awaiting approval"},{title:"Total Reports",value:(null==e?void 0:e.totalComplaints)||0,icon:n.Z,color:"bg-gradient-to-br from-orange-500 to-orange-600",subtitle:"Compliance reports"},{title:"Feeder Points",value:(null==e?void 0:e.totalFeederPoints)||0,icon:d.Z,color:"bg-gradient-to-br from-cyan-500 to-cyan-600",subtitle:"Monitoring locations"},{title:"Teams Active",value:(null==e?void 0:e.totalTeams)||0,icon:i.Z,color:"bg-gradient-to-br from-indigo-500 to-indigo-600",subtitle:"Operational teams"}];return(0,a.jsxs)("div",{className:"space-y-8 scrollable-content",children:[(0,a.jsxs)("div",{className:"relative overflow-hidden rounded-2xl sm:rounded-3xl bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 p-6 sm:p-8 text-white",children:[(0,a.jsxs)("div",{className:"relative z-10",children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold mb-2",children:"Taskforce Command Center"}),(0,a.jsx)("p",{className:"text-base sm:text-lg lg:text-xl opacity-90",children:"Real-time monitoring and management of your entire Taskforce ecosystem"})]}),(0,a.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 sm:w-64 sm:h-64 bg-white/10 rounded-full blur-3xl opacity-50"}),(0,a.jsx)("button",{onClick:loadDashboardData,className:"absolute top-4 right-4 btn-secondary p-2",children:(0,a.jsx)(u,{className:"h-5 w-5"})})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:j.map((e,t)=>(0,a.jsxs)("div",{className:"stat-card group",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between relative z-10",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-xs sm:text-sm font-medium text-gray-600 mb-2 truncate",children:e.title}),(0,a.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-3 space-y-1 sm:space-y-0",children:(0,a.jsx)("div",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:e.value})}),e.subtitle&&(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:e.subtitle})]}),(0,a.jsx)("div",{className:"p-3 sm:p-4 rounded-xl sm:rounded-2xl ".concat(e.color," transform group-hover:rotate-12 transition-transform duration-300 flex-shrink-0"),children:(0,a.jsx)(e.icon,{className:"h-6 w-6 sm:h-8 sm:w-8 text-white"})})]}),(0,a.jsx)("div",{className:"absolute bottom-0 left-0 h-1 bg-gradient-to-r from-blue-500 to-purple-500 w-full rounded-b-2xl"})]},e.title))}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[(0,a.jsx)(p.Z,{className:"h-6 w-6 mr-2 text-blue-600"}),"Feeder Points Overview"]}),(0,a.jsx)("a",{href:"/feeder-points",className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"View All →"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)("div",{className:"bg-blue-50 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(p.Z,{className:"h-8 w-8 text-blue-600"}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-blue-600",children:"Total Points"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-900",children:s.length})]})]})}),(0,a.jsx)("div",{className:"bg-green-50 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(h.Z,{className:"h-8 w-8 text-green-600"}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-green-600",children:"Active"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-900",children:s.filter(e=>"active"===e.status).length})]})]})}),(0,a.jsx)("div",{className:"bg-yellow-50 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(x.Z,{className:"h-8 w-8 text-yellow-600"}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-yellow-600",children:"Maintenance"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-yellow-900",children:s.filter(e=>"maintenance"===e.status).length})]})]})}),(0,a.jsx)("div",{className:"bg-purple-50 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(i.Z,{className:"h-8 w-8 text-purple-600"}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-purple-600",children:"Assigned"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-purple-900",children:s.filter(e=>e.assignedUserId||e.assignedTeamId).length})]})]})})]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Feeder Points"}),(0,a.jsxs)("div",{className:"space-y-3",children:[s.slice((v-1)*5,5*v).map((e,t)=>{var s;return(0,a.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"p-2 rounded-full ".concat("active"===e.status?"bg-green-100":"maintenance"===e.status?"bg-yellow-100":"bg-red-100"),children:(0,a.jsx)(p.Z,{className:"h-4 w-4 ".concat("active"===e.status?"text-green-600":"maintenance"===e.status?"text-yellow-600":"text-red-600")})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.name||"Feeder Point ".concat(t+1)}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-xs text-gray-500",children:[(0,a.jsx)(d.Z,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:(null===(s=e.location)||void 0===s?void 0:s.address)||"No location"}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full ".concat("active"===e.status?"bg-green-100 text-green-800":"maintenance"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:e.status})]})]})]},e.id||t)}),0===s.length&&(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(p.Z,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,a.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No feeder points"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Feeder points will appear here when they are created."})]}),s.length>5&&(0,a.jsxs)("div",{className:"flex justify-center mt-4 space-x-2",children:[(0,a.jsx)("button",{onClick:()=>y(e=>Math.max(1,e-1)),disabled:1===v,className:"btn-secondary px-3 py-1 rounded-md",children:"Previous"}),(0,a.jsxs)("span",{className:"text-gray-700 font-medium",children:["Page ",v," of ",Math.ceil(s.length/5)]}),(0,a.jsx)("button",{onClick:()=>y(e=>Math.min(Math.ceil(s.length/5),e+1)),disabled:v===Math.ceil(s.length/5),className:"btn-secondary px-3 py-1 rounded-md",children:"Next"})]})]})]})]})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Quick Actions"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)("a",{href:"/users",className:"btn-primary text-center block",children:"View All Users"}),(0,a.jsx)("a",{href:"/access-requests",className:"btn-secondary text-center block",children:"Review Pending Requests"})]})]})]})}function Dashboard(){return(0,a.jsx)(SimpleDashboard,{})}}},function(e){e.O(0,[16,868,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);